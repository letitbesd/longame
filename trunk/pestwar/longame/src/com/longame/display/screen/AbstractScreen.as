package com.longame.display.screen{	import com.longame.core.IDestroyable;	import com.longame.resource.ResourceManager;		import flash.display.DisplayObject;	import flash.display.Sprite;		import org.osflash.signals.Signal;

	/**	 * AbstractScreen Class	 * 	 * @author Sascha Balkau	 * @version 0.9.5	 */	public class AbstractScreen extends Sprite implements  IScreen	{		////////////////////////////////////////////////////////////////////////////////////////		// Properties                                                                         //		////////////////////////////////////////////////////////////////////////////////////////		protected var _backLayer:Sprite;		protected var _sceneLayer:Sprite;		protected var _uiLayer:Sprite;		protected var _popupLayer:Sprite;						protected var _onCreate:Signal=new Signal(AbstractScreen);				////////////////////////////////////////////////////////////////////////////////////////		// Public Methods                                                                     //		////////////////////////////////////////////////////////////////////////////////////////				/**		 * Creates a new AbstractScreen instance.		 */		public function AbstractScreen()		{			super();		}		/**		 * Used to create any display children (and other objects) that the display		 * contains.		 * 		 * @private		 */		protected function createChildren() : void		{			this._backLayer=new Sprite();			this.addChild(this._backLayer);						this._sceneLayer=new Sprite();			this.addChild(this._sceneLayer);						this._uiLayer=new Sprite();			this.addChild(this._uiLayer);						this._popupLayer=new Sprite();			this.addChild(this._popupLayer);		}		/**		 * 创建场景，覆盖		 * */		protected function createScene():void		{					}		/**		 * 创建ui，覆盖		 * */		protected function createUi():void		{					}		public function onShow():void		{					}				public function onHide():void		{					}					////////////////////////////////////////////////////////////////////////////////////////		// Getters & Setters                                                                  //		////////////////////////////////////////////////////////////////////////////////////////		public function get backLayer():Sprite{			return this._backLayer;		}		public function get sceneLayer():Sprite{			return this._sceneLayer;		}		public function get uiLayer():Sprite{		    return this._uiLayer;			}		public function get popupLayer():Sprite{			return this._popupLayer;		}		public function get onCreate():Signal		{			return _onCreate;		}		////////////////////////////////////////////////////////////////////////////////////////		// Properties                                                                         //		////////////////////////////////////////////////////////////////////////////////////////				/**		 * @private		 */		protected var _enabled:Boolean = true;				/**		 * @private		 */		protected var _started:Boolean = false;						////////////////////////////////////////////////////////////////////////////////////////		// Public Methods                                                                     //		////////////////////////////////////////////////////////////////////////////////////////		/**		 * @inheritDoc		 */		public function load():void		{			onAssetsLoaded(null);		}						/**		 * @inheritDoc		 */		public function start():void		{			if (_started) return;			_started = true;		}						/**		 * @inheritDoc		 */		public function stop():void		{			if (!_started) return;			_started = false;		}		/**		 * @inheritDoc		 */		public function update(para:Object=null):void		{           //to be inherited		}				protected var _destroyed:Boolean=false;		public function get destroyed():Boolean		{			return this._destroyed;		}		/**		 * @inheritDoc		 */		public function destroy():void		{			if(this._destroyed) return;			this._destroyed=true;			stop();			removeEventListeners();			unload();		}						/**		 * @inheritDoc		 */		override public function toString():String		{			return "AbstractScreen";		}						////////////////////////////////////////////////////////////////////////////////////////		// Getters & Setters                                                                  //		////////////////////////////////////////////////////////////////////////////////////////				/**		 * @inheritDoc		 */		public function get enabled():Boolean		{			return _enabled;		}		public function set enabled(v:Boolean):void		{			if (v == _enabled) return;			_enabled = v;			if (_enabled) enableChildren();			else disableChildren();		}						/**		 * @inheritDoc		 */		public function get started():Boolean		{			return _started;		}				////////////////////////////////////////////////////////////////////////////////////////		// Event Handlers                                                                     //		////////////////////////////////////////////////////////////////////////////////////////				/**		 * Called after the display assets loading has finished.		 * 		 * @private		 */		protected function onAssetsLoaded(e:Object=null):void		{			setup();			ResourceManager.instance.onComplete.remove(this.onAssetsLoaded);		}		////////////////////////////////////////////////////////////////////////////////////////		// Private Methods                                                                    //		////////////////////////////////////////////////////////////////////////////////////////				/**		 * Sets up the display. This method should only be called once after object		 * instantiation. It initiates the display by creating child objects and adding		 * event listeners.		 * 		 * @private		 */		protected function setup():void		{			createChildren();			createUi();			createScene();			addEventListeners();			this.onCreate.dispatch(this);		}		/**		 * enableChildren		 * @private		 */		protected function enableChildren():void		{			/* Abstract method! */		}						/**		 * disableChildren		 * @private		 */		protected function disableChildren():void		{			/* Abstract method! */		}		/**		 * Should be used to add any required event listeners to the display and/or it's		 * children.		 * 		 * @private		 */		protected function addEventListeners():void		{			/* Abstract method! */		}						/**		 * Used to remove any event listeners that has been added with addEventListeners().		 * This method is automatically called by the destroy() method.		 * 		 * @private		 */		protected function removeEventListeners():void		{			/* Abstract method! */				}		/**		 * Should be used to unload any assets that have been loaded for the display.		 * 		 * @private		 */		protected function unload():void		{			/* Abstract method! */			if(this.parent){				this.parent.removeChild(this);			}		}	}}